{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"HW7","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyPzOqHws2BVUL9KgqQVqI3N"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"a4870a456dc54d18b82d224050aa312d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_a9d0a2960b6d44af9706fdf89c0d91c4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_55c5901036414795b511e03e6d70b8be","IPY_MODEL_a521252696a84f7887d28090a420c026","IPY_MODEL_21ab34e0567a4488aa2058d8e427f2a9"]}},"a9d0a2960b6d44af9706fdf89c0d91c4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"55c5901036414795b511e03e6d70b8be":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_6c7c6c20ec084ab483dc0b74d4a6bdac","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_249b3d4559934430af85769b6d514152"}},"a521252696a84f7887d28090a420c026":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b1c012c1f37a4b78b064e7a6fa061f09","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":3493,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":3493,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_606adf40eb5e41c2a1c95b624dd49dc7"}},"21ab34e0567a4488aa2058d8e427f2a9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cb1eda64aac84b238b264a5ba89efd2b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 3493/3493 [01:20&lt;00:00, 45.00it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c6f6a48a66f84d22bc58d5abf0654619"}},"6c7c6c20ec084ab483dc0b74d4a6bdac":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"249b3d4559934430af85769b6d514152":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b1c012c1f37a4b78b064e7a6fa061f09":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"606adf40eb5e41c2a1c95b624dd49dc7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cb1eda64aac84b238b264a5ba89efd2b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c6f6a48a66f84d22bc58d5abf0654619":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d61a2a601de947968681ed7926e9b290":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_3e7b8628835e4f88b68e89a6427f177a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_43dac42b68094074bdc850a37a86e1e5","IPY_MODEL_49b06f36f87447a48468621a9bd21a0e","IPY_MODEL_c6b54fa513e2420c96586430a8579290"]}},"3e7b8628835e4f88b68e89a6427f177a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"43dac42b68094074bdc850a37a86e1e5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_2936fd96b4f040f7961ceb9a9630b4a9","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4dd3c9c9fabb41dc9dbae6e190750a36"}},"49b06f36f87447a48468621a9bd21a0e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_99f927b39b5f43c99d5d01d1f645f4a8","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":624,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":624,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_529e69d5342f406791b081753910a110"}},"c6b54fa513e2420c96586430a8579290":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a14ceb27ac114cdcb59d579cc89ad8ff","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 624/624 [00:00&lt;00:00, 18.3kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d7ee82ea7ba9449e95e1544e66cde886"}},"2936fd96b4f040f7961ceb9a9630b4a9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"4dd3c9c9fabb41dc9dbae6e190750a36":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"99f927b39b5f43c99d5d01d1f645f4a8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"529e69d5342f406791b081753910a110":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a14ceb27ac114cdcb59d579cc89ad8ff":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d7ee82ea7ba9449e95e1544e66cde886":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4391a0f27bf0451bbf4f5c177c1c3bfd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_8279087fc83c456eb7f623664fc8c9ff","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_0bd040dbe49043128abf803cb175d84c","IPY_MODEL_557aefcf702249a5a12bf0dd473e2bff","IPY_MODEL_f70912f1c0914d1988e93d9015a7f3e4"]}},"8279087fc83c456eb7f623664fc8c9ff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0bd040dbe49043128abf803cb175d84c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3e8d48de6ef14d3aae553f88e629120c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_045aa8b3268c4f50aacd5284c45b8e66"}},"557aefcf702249a5a12bf0dd473e2bff":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f483390ba1f34835a6685fc517ad965a","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":411577189,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":411577189,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6f496de60dac43daaae2606f9750099c"}},"f70912f1c0914d1988e93d9015a7f3e4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f45d8fd6da584d82b9b14c6ef486550c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 412M/412M [00:07&lt;00:00, 58.7MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_74e58a600d7a46919e4f2d917806292b"}},"3e8d48de6ef14d3aae553f88e629120c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"045aa8b3268c4f50aacd5284c45b8e66":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f483390ba1f34835a6685fc517ad965a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"6f496de60dac43daaae2606f9750099c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f45d8fd6da584d82b9b14c6ef486550c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"74e58a600d7a46919e4f2d917806292b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7caf02f11bf746d2bd0eff47b26e6045":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_57749cce80ea4bbebd88b8051cbe062b","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_047d7f1af4c540d7baf8c6b1c57a953a","IPY_MODEL_5f14860f5c5e4ffba12f74fe5c5b077b","IPY_MODEL_7ec1768484114dfa9f6842aecbb10afb"]}},"57749cce80ea4bbebd88b8051cbe062b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"047d7f1af4c540d7baf8c6b1c57a953a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_14d0442b6e264c2e9fb9d8cb80b82c93","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9315681f16304759a27d1c45d602e494"}},"5f14860f5c5e4ffba12f74fe5c5b077b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9996db68097c44bfbee935419dca2469","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":109540,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":109540,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_82a2b8dbb463403fa33d5ff115c92bbb"}},"7ec1768484114dfa9f6842aecbb10afb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_47038c8df9144ff8b00ca2db56fe48af","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 110k/110k [00:00&lt;00:00, 1.19MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_507096633cd74f2ea4a6e1da158943e7"}},"14d0442b6e264c2e9fb9d8cb80b82c93":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"9315681f16304759a27d1c45d602e494":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9996db68097c44bfbee935419dca2469":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"82a2b8dbb463403fa33d5ff115c92bbb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"47038c8df9144ff8b00ca2db56fe48af":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"507096633cd74f2ea4a6e1da158943e7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"124d063e5a564791b3936b755c05707d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b54cfee7cfa74f4b85fcf49d493ac691","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a639d54258d94cdebf47f4728a7bb1f4","IPY_MODEL_a1228a45033b4bb999f4ad75ce4a5645","IPY_MODEL_2e75658f282946adbd3663a533885027"]}},"b54cfee7cfa74f4b85fcf49d493ac691":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a639d54258d94cdebf47f4728a7bb1f4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ffbcedc706714d98ac6ee3b7ea43450e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b5235968557a4563addfe60f064f4bab"}},"a1228a45033b4bb999f4ad75ce4a5645":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e094223bee954084ac47503094234dd2","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":268943,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":268943,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2ca56ab7c0ff4e61a6c3842900b178da"}},"2e75658f282946adbd3663a533885027":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0d68983ba7b34fc7bf410e99886bb277","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 269k/269k [00:00&lt;00:00, 612kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_bef2bce63f824f8ebef6fe05d5b881b8"}},"ffbcedc706714d98ac6ee3b7ea43450e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b5235968557a4563addfe60f064f4bab":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e094223bee954084ac47503094234dd2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"2ca56ab7c0ff4e61a6c3842900b178da":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0d68983ba7b34fc7bf410e99886bb277":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"bef2bce63f824f8ebef6fe05d5b881b8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bf717a26a06341e381a8faa943da35e6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_a2d93500897a4d67b66cbefdb35731ff","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a332a41cb2c2484190c4bd17f711cd9c","IPY_MODEL_d9110ee5ce14440c98b9ebb18f238123","IPY_MODEL_2897bbf9dbe540c9978949f89705e41f"]}},"a2d93500897a4d67b66cbefdb35731ff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a332a41cb2c2484190c4bd17f711cd9c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_113ceb73b8a34ea9b582e14e11b858e8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_190bb6defc6b4b36b02b2e88ed29ab79"}},"d9110ee5ce14440c98b9ebb18f238123":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_92d5d676f03b4f638b1a41ba157db36a","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":29,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":29,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_628859b5473a4afc8b5b64a2d607ea48"}},"2897bbf9dbe540c9978949f89705e41f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d2c02db3d62c46009bcf47407fc5bab7","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 29.0/29.0 [00:00&lt;00:00, 729B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d2bcdd877fce433395442a82e97cc6d9"}},"113ceb73b8a34ea9b582e14e11b858e8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"190bb6defc6b4b36b02b2e88ed29ab79":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"92d5d676f03b4f638b1a41ba157db36a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"628859b5473a4afc8b5b64a2d607ea48":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d2c02db3d62c46009bcf47407fc5bab7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d2bcdd877fce433395442a82e97cc6d9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bf7fe1e0e80442a9a0f0552caebd2b99":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5441904207214c6cb4af9dd56b2082bc","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_82e64ada0d0b419db684884622498674","IPY_MODEL_930b46e5f0c545d0bf46c8e1c35d8990","IPY_MODEL_7616c675bdd44af285c5644bf8792a3e"]}},"5441904207214c6cb4af9dd56b2082bc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"82e64ada0d0b419db684884622498674":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_7d05cfc09de2446f875f90910fc47467","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_876f89ee7b054c9b8a734894dacd22a0"}},"930b46e5f0c545d0bf46c8e1c35d8990":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7e54045a22d046aba952cc3f68f9d4d1","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1684,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1684,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_06bda406b24c4333895d04651dae1b29"}},"7616c675bdd44af285c5644bf8792a3e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_133ab8fc57f244948edb50d9aa1db759","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1684/1684 [07:28&lt;00:00,  4.25it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_58aad3f417a54987ad4a1ab292462031"}},"7d05cfc09de2446f875f90910fc47467":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"876f89ee7b054c9b8a734894dacd22a0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7e54045a22d046aba952cc3f68f9d4d1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"06bda406b24c4333895d04651dae1b29":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"133ab8fc57f244948edb50d9aa1db759":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"58aad3f417a54987ad4a1ab292462031":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"73e46901d34447dfab645aab2c72d82d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_7da98619ff664789a734d5b555c3ae12","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a5ca53798b1e4066903282396c1544cf","IPY_MODEL_8d811cb125894a12a44685762bdea6e1","IPY_MODEL_c339f0331cb3494faf8dbfc70f24cb02"]}},"7da98619ff664789a734d5b555c3ae12":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a5ca53798b1e4066903282396c1544cf":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f713e3c4d8ce41e2a3cf737500e3b095","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_791b818795ed4ee798640a458d119c16"}},"8d811cb125894a12a44685762bdea6e1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_c3842c27c2d84f998e1b1567cea7c863","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":3524,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":3524,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f4c52637a0d74679bdeadfb8108554a7"}},"c339f0331cb3494faf8dbfc70f24cb02":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f3f22f86171e4662a080a3bbfd63a126","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 3524/3524 [01:24&lt;00:00, 43.41it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6fd30e2cb0eb4cfcaefe109ba9b8bba0"}},"f713e3c4d8ce41e2a3cf737500e3b095":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"791b818795ed4ee798640a458d119c16":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c3842c27c2d84f998e1b1567cea7c863":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f4c52637a0d74679bdeadfb8108554a7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f3f22f86171e4662a080a3bbfd63a126":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"6fd30e2cb0eb4cfcaefe109ba9b8bba0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1osWa9stb-j9","executionInfo":{"status":"ok","timestamp":1644538407961,"user_tz":-480,"elapsed":5625,"user":{"displayName":"mark wu","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"04816660482965861860"}},"outputId":"cbecef6a-457e-4046-bcdf-7563838f3c8d"},"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading...\n","From: https://drive.google.com/uc?id=1znKmX08v9Fygp-dgwo7BKiLIf2qL1FH1\n","To: /content/hw7_data.zip\n","100% 7.71M/7.71M [00:00<00:00, 60.3MB/s]\n","Archive:  hw7_data.zip\n","  inflating: hw7_dev.json            \n","  inflating: hw7_test.json           \n","  inflating: hw7_train.json          \n"]}],"source":["!gdown --id '1znKmX08v9Fygp-dgwo7BKiLIf2qL1FH1' --output hw7_data.zip\n","!unzip -o hw7_data"]},{"cell_type":"code","source":["!nvidia-smi"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7w1QpnS1cwu0","executionInfo":{"status":"ok","timestamp":1644538411874,"user_tz":-480,"elapsed":390,"user":{"displayName":"mark wu","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"04816660482965861860"}},"outputId":"e068ffc8-958f-4270-bf45-2f90c5e278a3"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Fri Feb 11 00:13:31 2022       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 460.32.03    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   54C    P8    10W /  70W |      0MiB / 15109MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["!pip install transformers==4.5.0"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6EhwQ1bkcyiY","executionInfo":{"status":"ok","timestamp":1644538421079,"user_tz":-480,"elapsed":6369,"user":{"displayName":"mark wu","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"04816660482965861860"}},"outputId":"fccdc2c7-34a6-4ba0-9eb9-419648cb58b3"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting transformers==4.5.0\n","  Downloading transformers-4.5.0-py3-none-any.whl (2.1 MB)\n","\u001b[K     |████████████████████████████████| 2.1 MB 5.1 MB/s \n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers==4.5.0) (3.4.2)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers==4.5.0) (1.19.5)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers==4.5.0) (4.10.1)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from transformers==4.5.0) (21.3)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers==4.5.0) (2.23.0)\n","Collecting tokenizers<0.11,>=0.10.1\n","  Downloading tokenizers-0.10.3-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (3.3 MB)\n","\u001b[K     |████████████████████████████████| 3.3 MB 50.2 MB/s \n","\u001b[?25hRequirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers==4.5.0) (2019.12.20)\n","Collecting sacremoses\n","  Downloading sacremoses-0.0.47-py2.py3-none-any.whl (895 kB)\n","\u001b[K     |████████████████████████████████| 895 kB 37.0 MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers==4.5.0) (4.62.3)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers==4.5.0) (3.7.0)\n","Requirement already satisfied: typing-extensions>=3.6.4 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers==4.5.0) (3.10.0.2)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->transformers==4.5.0) (3.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.5.0) (2021.10.8)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.5.0) (3.0.4)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.5.0) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.5.0) (1.24.3)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==4.5.0) (7.1.2)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==4.5.0) (1.15.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==4.5.0) (1.1.0)\n","Installing collected packages: tokenizers, sacremoses, transformers\n","Successfully installed sacremoses-0.0.47 tokenizers-0.10.3 transformers-4.5.0\n"]}]},{"cell_type":"code","source":["import json\n","import numpy as np\n","import random\n","import torch\n","from torch.utils.data import Dataset, DataLoader\n","from transformers import AdamW, BertForQuestionAnswering, BertTokenizerFast\n","from tqdm.auto import tqdm\n","\n","device = 'cuda' if torch.cuda.is_available() else 'cpu'\n","\n","def same_seeds(seed):\n","  torch.manual_seed(seed)\n","  if torch.cuda.is_available():\n","    torch.cuda.manual_seed(seed)\n","    torch.cuda.manual_seed_all(seed)\n","    np.random.seed(seed)\n","    random.seed(seed)\n","    torch.backends.cudnn.benchmark = False\n","    torch.backends.cudnn.deterministic = True\n","  smae_seed(2022)"],"metadata":{"id":"C-WDzsZ_dJLp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["fp16_training = True\n","\n","if fp16_training:\n","  !pip install accelerate==0.2.0\n","  from accelerate import Accelerator\n","  accelerator = Accelerator(fp16= True)\n","  device = accelerator.device"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6po3mZkdebc3","executionInfo":{"status":"ok","timestamp":1644538440402,"user_tz":-480,"elapsed":3060,"user":{"displayName":"mark wu","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"04816660482965861860"}},"outputId":"33b9016c-3992-4209-fa94-1bf841dca2a2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting accelerate==0.2.0\n","  Downloading accelerate-0.2.0-py3-none-any.whl (47 kB)\n","\u001b[?25l\r\u001b[K     |███████                         | 10 kB 21.8 MB/s eta 0:00:01\r\u001b[K     |█████████████▉                  | 20 kB 10.3 MB/s eta 0:00:01\r\u001b[K     |████████████████████▉           | 30 kB 8.7 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▊    | 40 kB 8.0 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 47 kB 2.5 MB/s \n","\u001b[?25hCollecting pyaml>=20.4.0\n","  Downloading pyaml-21.10.1-py2.py3-none-any.whl (24 kB)\n","Requirement already satisfied: torch>=1.4.0 in /usr/local/lib/python3.7/dist-packages (from accelerate==0.2.0) (1.10.0+cu111)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.7/dist-packages (from pyaml>=20.4.0->accelerate==0.2.0) (3.13)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch>=1.4.0->accelerate==0.2.0) (3.10.0.2)\n","Installing collected packages: pyaml, accelerate\n","Successfully installed accelerate-0.2.0 pyaml-21.10.1\n"]}]},{"cell_type":"code","source":["model = BertForQuestionAnswering.from_pretrained('bert-base-chinese').to(device)\n","tokenizer = BertTokenizerFast.from_pretrained('bert-base-chinese')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":344,"referenced_widgets":["d61a2a601de947968681ed7926e9b290","3e7b8628835e4f88b68e89a6427f177a","43dac42b68094074bdc850a37a86e1e5","49b06f36f87447a48468621a9bd21a0e","c6b54fa513e2420c96586430a8579290","2936fd96b4f040f7961ceb9a9630b4a9","4dd3c9c9fabb41dc9dbae6e190750a36","99f927b39b5f43c99d5d01d1f645f4a8","529e69d5342f406791b081753910a110","a14ceb27ac114cdcb59d579cc89ad8ff","d7ee82ea7ba9449e95e1544e66cde886","4391a0f27bf0451bbf4f5c177c1c3bfd","8279087fc83c456eb7f623664fc8c9ff","0bd040dbe49043128abf803cb175d84c","557aefcf702249a5a12bf0dd473e2bff","f70912f1c0914d1988e93d9015a7f3e4","3e8d48de6ef14d3aae553f88e629120c","045aa8b3268c4f50aacd5284c45b8e66","f483390ba1f34835a6685fc517ad965a","6f496de60dac43daaae2606f9750099c","f45d8fd6da584d82b9b14c6ef486550c","74e58a600d7a46919e4f2d917806292b","7caf02f11bf746d2bd0eff47b26e6045","57749cce80ea4bbebd88b8051cbe062b","047d7f1af4c540d7baf8c6b1c57a953a","5f14860f5c5e4ffba12f74fe5c5b077b","7ec1768484114dfa9f6842aecbb10afb","14d0442b6e264c2e9fb9d8cb80b82c93","9315681f16304759a27d1c45d602e494","9996db68097c44bfbee935419dca2469","82a2b8dbb463403fa33d5ff115c92bbb","47038c8df9144ff8b00ca2db56fe48af","507096633cd74f2ea4a6e1da158943e7","124d063e5a564791b3936b755c05707d","b54cfee7cfa74f4b85fcf49d493ac691","a639d54258d94cdebf47f4728a7bb1f4","a1228a45033b4bb999f4ad75ce4a5645","2e75658f282946adbd3663a533885027","ffbcedc706714d98ac6ee3b7ea43450e","b5235968557a4563addfe60f064f4bab","e094223bee954084ac47503094234dd2","2ca56ab7c0ff4e61a6c3842900b178da","0d68983ba7b34fc7bf410e99886bb277","bef2bce63f824f8ebef6fe05d5b881b8","bf717a26a06341e381a8faa943da35e6","a2d93500897a4d67b66cbefdb35731ff","a332a41cb2c2484190c4bd17f711cd9c","d9110ee5ce14440c98b9ebb18f238123","2897bbf9dbe540c9978949f89705e41f","113ceb73b8a34ea9b582e14e11b858e8","190bb6defc6b4b36b02b2e88ed29ab79","92d5d676f03b4f638b1a41ba157db36a","628859b5473a4afc8b5b64a2d607ea48","d2c02db3d62c46009bcf47407fc5bab7","d2bcdd877fce433395442a82e97cc6d9"]},"id":"lyRd66BFe2d2","executionInfo":{"status":"ok","timestamp":1644538493064,"user_tz":-480,"elapsed":25280,"user":{"displayName":"mark wu","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"04816660482965861860"}},"outputId":"71b9362a-9087-4dd3-fbe7-2c39ff811591"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d61a2a601de947968681ed7926e9b290","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/624 [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4391a0f27bf0451bbf4f5c177c1c3bfd","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/412M [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at bert-base-chinese were not used when initializing BertForQuestionAnswering: ['cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias']\n","- This IS expected if you are initializing BertForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at bert-base-chinese and are newly initialized: ['qa_outputs.weight', 'qa_outputs.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"7caf02f11bf746d2bd0eff47b26e6045","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/110k [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"124d063e5a564791b3936b755c05707d","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/269k [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"bf717a26a06341e381a8faa943da35e6","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/29.0 [00:00<?, ?B/s]"]},"metadata":{}}]},{"cell_type":"code","source":["def read_data(file):\n","  with open(file, 'r', encoding= 'utf-8') as reader:\n","    data = json.load(reader)\n","  return data['questions'], data['paragraphs']\n","\n","train_questions, train_paragraphs = read_data('hw7_train.json')\n","dev_questions, dev_paragraphs = read_data('hw7_dev.json')\n","test_questions, test_paragraphs = read_data('hw7_test.json')"],"metadata":{"id":"d4ZiIA6NfVQs"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_questions_tokenized = tokenizer([train_question['question_text'] for train_question in train_questions], add_special_tokens= False)\n","dev_questions_tokenized = tokenizer([dev_question['question_text'] for dev_question in dev_questions], add_special_tokens= False)\n","test_questions_tokenized = tokenizer([test_question['question_text'] for test_question in test_questions], add_special_tokens= False)\n","\n","train_paragraphs_tokenized = tokenizer(train_paragraphs, add_special_tokens= False)\n","dev_paragraphs_tokenized = tokenizer(dev_paragraphs, add_special_tokens= False)\n","test_paragraphs_tokenized = tokenizer(test_paragraphs,add_special_tokens= False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8P0jgaiVg5P7","executionInfo":{"status":"ok","timestamp":1644538503838,"user_tz":-480,"elapsed":7196,"user":{"displayName":"mark wu","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"04816660482965861860"}},"outputId":"dbe539c0-5248-4955-825a-1d322a1a0e72"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Token indices sequence length is longer than the specified maximum sequence length for this model (570 > 512). Running this sequence through the model will result in indexing errors\n"]}]},{"cell_type":"code","source":["class QA_Dataset(Dataset):\n","  def __init__(self, split, questions, tokenized_questions, tokenized_paragraphs):\n","    self.split = split\n","    self.questions = questions\n","    self.tokenized_questions = tokenized_questions\n","    self.tokenized_paragraphs = tokenized_paragraphs\n","    self.max_question_len = 40\n","    self.max_paragraph_len = 150\n","\n","    self.doc_stride = 150 #300\n","\n","    self.max_seq_len = 1 + self.max_question_len + 1 + self.max_paragraph_len + 1\n","\n","  def __len__(self):\n","    return len(self.questions)\n","\n","  def __getitem__(self, idx):\n","    question = self.questions[idx]\n","    tokenized_question = self.tokenized_questions[idx]\n","    tokenized_paragraph = self.tokenized_paragraphs[question['paragraph_id']]\n","    \n","    if self.split =='train':\n","      answer_start_token = tokenized_paragraph.char_to_token(question['answer_start'])\n","      answer_end_token = tokenized_paragraph.char_to_token(question['answer_end'])\n","\n","      mid = (answer_start_token + answer_end_token) // 2\n","      paragraph_start = max(0, min(mid - self.max_paragraph_len // 2, len(tokenized_paragraph) - self.max_paragraph_len))\n","      paragraph_end = paragraph_start + self.max_paragraph_len\n","\n","      input_ids_question = [101] + tokenized_question.ids[:self.max_question_len] + [102]     \n","      input_ids_paragraph = tokenized_paragraph.ids[paragraph_start : paragraph_end] + [102]\n","\n","      answer_start_token += len(input_ids_question) - paragraph_start\n","      answer_end_token += len(input_ids_question) - paragraph_start\n","\n","      input_ids, token_type_ids, attention_mask = self.padding(input_ids_question, input_ids_paragraph)\n","      return torch.tensor(input_ids), torch.tensor(token_type_ids), torch.tensor(attention_mask), answer_start_token, answer_end_token\n","\n","    else:\n","      input_ids_list, token_type_ids_list, attention_mask_list = [], [], []\n","\n","      for i in range(0, len(tokenized_paragraph), self.doc_stride):\n","        input_ids_question = [101] + tokenized_question.ids[:self.max_question_len] + [102]\n","        input_ids_paragraph = tokenized_paragraph.ids[i : i + self.max_paragraph_len] + [102]\n","        input_ids, token_type_ids, attention_mask = self.padding(input_ids_question, input_ids_paragraph)\n","\n","        input_ids_list.append(input_ids)\n","        token_type_ids_list.append(token_type_ids)\n","        attention_mask_list.append(attention_mask)\n","\n","      return torch.tensor(input_ids_list), torch.tensor(token_type_ids_list), torch.tensor(attention_mask_list)\n","\n","  def padding(self, input_ids_question, input_ids_paragraph):\n","    padding_len = self.max_seq_len - len(input_ids_question) - len(input_ids_paragraph)\n","    input_ids = input_ids_question + input_ids_paragraph + [0] * padding_len\n","    token_type_ids = [0] * len(input_ids_question) + [1] * len(input_ids_paragraph) + [0] * padding_len\n","    attention_mask = [1] * (len(input_ids_question) + len(input_ids_paragraph)) + [0] * padding_len\n","    \n","    return input_ids, token_type_ids, attention_mask\n","\n","train_set = QA_Dataset('train', train_questions, train_questions_tokenized, train_paragraphs_tokenized)\n","dev_set = QA_Dataset('dev', dev_questions, dev_questions_tokenized, dev_paragraphs_tokenized)\n","test_set = QA_Dataset('test', test_questions, test_questions_tokenized, test_paragraphs_tokenized)\n","\n","train_batch_size = 16\n","\n","train_loader = DataLoader(train_set, batch_size= train_batch_size, shuffle= True, pin_memory = True)\n","dev_loader = DataLoader(dev_set, batch_size= 1, shuffle= False, pin_memory= True)\n","test_loader = DataLoader(test_set, batch_size= 1, shuffle= False, pin_memory= True)\n"],"metadata":{"id":"ZVh92466lTm9"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def evaluate(data, output):\n","  answer = ''\n","  max_prob = float('-inf')\n","  num_of_windows = data[0].shape[1]\n","\n","  for k in range(num_of_windows):\n","    start_prob, start_index = torch.max(output.start_logits[k], dim= 0)\n","    end_prob, end_index= torch.max(output.end_logits[k], dim= 0)\n","\n","    prob = start_prob + end_prob\n","\n","    if prob > max_prob:\n","      max_prob = prob\n","      answer = tokenizer.decode(data[0][0][k][start_index : end_index + 1])\n","\n","  return answer.replace(' ', '')  "],"metadata":{"id":"F9AGeXUt0bxg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["num_epoch = 1\n","validation = True\n","logging_step = 100\n","learning_rate = 1e-4\n","optimizer = AdamW(model.parameters(), lr = learning_rate)\n","\n","if fp16_training:\n","  model, optimizer, train_loader = accelerator.prepare(model, optimizer, train_loader)\n","\n","model.train()\n","\n","print('Start Training ...')\n","\n","for epoch in range(num_epoch):\n","  step = 1\n","  train_loss = train_acc = 0\n","\n","  for data in tqdm(train_loader):\n","    data = [i.to(device) for i in data]\n","\n","    output = model(input_ids=data[0], token_type_ids= data[1], attention_mask=data[2], start_positions= data[3], end_positions= data[4])\n","    \n","    start_index = torch.argmax(output.start_logits, dim= 1)\n","    end_index = torch.argmax(output.end_logits, dim= 1)\n","\n","    train_acc += ((start_index == data[3]) & (end_index == data[4])).float().mean()\n","    train_loss += output.loss\n","\n","    if fp16_training:\n","      accelerator.backward(output.loss)\n","    else:\n","      output.loss.backward()\n","\n","    optimizer.step()\n","    optimizer.zero_grad()\n","    step += 1\n","\n","    if step % logging_step == 0:\n","      print(f'Epoch {epoch + 1} | Step {step} | loss = {train_loss.item() / logging_step:.3f}, acc = {train_acc / logging_step:.3f}')\n","      train_loss = train_acc = 0\n","  \n","  if validation:\n","    print('Evaluating Dev Set ...')\n","    model.eval()\n","    with torch.no_grad():\n","      dev_acc = 0\n","      for i, data in enumerate(tqdm(dev_loader)):\n","        output = model(input_ids= data[0].squeeze(dim= 0).to(device),token_type_ids= data[1].squeeze(dim= 0).to(device),\n","                        attention_mask= data[2].squeeze(dim=0).to(device))\n","        dev_acc += evaluate(data, output) == dev_questions[i]['answer_text']\n","      print(f'Validation | Epoch {epoch + 1} | acc = {dev_acc / len(dev_loader):.3f}')\n","    model.train()\n","\n","    \n","print('Saving Model ...')\n","model_save_dir = 'saved_model'\n","model.save_pretrained(model_save_dir)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":443,"referenced_widgets":["bf7fe1e0e80442a9a0f0552caebd2b99","5441904207214c6cb4af9dd56b2082bc","82e64ada0d0b419db684884622498674","930b46e5f0c545d0bf46c8e1c35d8990","7616c675bdd44af285c5644bf8792a3e","7d05cfc09de2446f875f90910fc47467","876f89ee7b054c9b8a734894dacd22a0","7e54045a22d046aba952cc3f68f9d4d1","06bda406b24c4333895d04651dae1b29","133ab8fc57f244948edb50d9aa1db759","58aad3f417a54987ad4a1ab292462031","73e46901d34447dfab645aab2c72d82d","7da98619ff664789a734d5b555c3ae12","a5ca53798b1e4066903282396c1544cf","8d811cb125894a12a44685762bdea6e1","c339f0331cb3494faf8dbfc70f24cb02","f713e3c4d8ce41e2a3cf737500e3b095","791b818795ed4ee798640a458d119c16","c3842c27c2d84f998e1b1567cea7c863","f4c52637a0d74679bdeadfb8108554a7","f3f22f86171e4662a080a3bbfd63a126","6fd30e2cb0eb4cfcaefe109ba9b8bba0"]},"id":"facYC2QO1Z1p","executionInfo":{"status":"ok","timestamp":1644539063829,"user_tz":-480,"elapsed":534227,"user":{"displayName":"mark wu","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"04816660482965861860"}},"outputId":"a6a77418-e09a-49cf-c6e1-73496a942edd"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Start Training ...\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"bf7fe1e0e80442a9a0f0552caebd2b99","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1684 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Epoch 1 | Step 100 | loss = 1.960, acc = 0.344\n","Epoch 1 | Step 200 | loss = 1.007, acc = 0.607\n","Epoch 1 | Step 300 | loss = 0.839, acc = 0.672\n","Epoch 1 | Step 400 | loss = 0.783, acc = 0.684\n","Epoch 1 | Step 500 | loss = 0.732, acc = 0.694\n","Epoch 1 | Step 600 | loss = 0.743, acc = 0.691\n","Epoch 1 | Step 700 | loss = 0.715, acc = 0.684\n","Epoch 1 | Step 800 | loss = 0.748, acc = 0.691\n","Epoch 1 | Step 900 | loss = 0.713, acc = 0.692\n","Epoch 1 | Step 1000 | loss = 0.690, acc = 0.687\n","Epoch 1 | Step 1100 | loss = 0.668, acc = 0.716\n","Epoch 1 | Step 1200 | loss = 0.623, acc = 0.727\n","Epoch 1 | Step 1300 | loss = 0.618, acc = 0.727\n","Epoch 1 | Step 1400 | loss = 0.642, acc = 0.715\n","Epoch 1 | Step 1500 | loss = 0.649, acc = 0.701\n","Epoch 1 | Step 1600 | loss = 0.671, acc = 0.706\n","Evaluating Dev Set ...\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"73e46901d34447dfab645aab2c72d82d","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/3524 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Validation | Epoch 1 | acc = 0.484\n","Saving Model ...\n"]}]},{"cell_type":"code","source":["print('Evaluating Test Set ...')\n","result = []\n","\n","model.eval()\n","with torch.no_grad():\n","  for data in tqdm(test_loader):\n","    output = model(input_ids= data[0].squeeze(dim= 0).to(device), token_type_ids= data[1].squeeze(dim= 0).to(device),\n","                   attention_mask= data[2].squeeze(dim= 0).to(device))\n","    result.append(evaluate(data, output))\n","\n","result_file = 'result.csv'\n","with open(result_file, 'w') as f:\n","  f.write('ID, Answer\\n')\n","  for i, test_question in enumerate(test_questions):\n","    f.write(f\"{test_question['id']}, {result[i].replace(',','')}\\n\")\n","\n","print(f'Completed! Result is in {result_file}')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":85,"referenced_widgets":["a4870a456dc54d18b82d224050aa312d","a9d0a2960b6d44af9706fdf89c0d91c4","55c5901036414795b511e03e6d70b8be","a521252696a84f7887d28090a420c026","21ab34e0567a4488aa2058d8e427f2a9","6c7c6c20ec084ab483dc0b74d4a6bdac","249b3d4559934430af85769b6d514152","b1c012c1f37a4b78b064e7a6fa061f09","606adf40eb5e41c2a1c95b624dd49dc7","cb1eda64aac84b238b264a5ba89efd2b","c6f6a48a66f84d22bc58d5abf0654619"]},"id":"RLMSRDU2JV22","executionInfo":{"status":"ok","timestamp":1644489723498,"user_tz":-480,"elapsed":81089,"user":{"displayName":"mark wu","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"04816660482965861860"}},"outputId":"8c9625a3-7769-4c81-fe77-da3852782ee5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Evaluating Test Set ...\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a4870a456dc54d18b82d224050aa312d","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/3493 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Completed! Result is in result.csv\n"]}]}]}